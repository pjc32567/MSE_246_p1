rm(list = ls())
cd
getwd()
library(dplyr)
library(GGally)
df <- read.csv("SBA_loan_data_new.csv")
set.seed(1)
# Filtering out Loans which are canceled or exempt
df_new <- df
df_new <- filter(df_new, LoanStatus != "CANCLD")
df_new <- filter(df_new, LoanStatus != "EXEMPT")
df_new <- filter(df_new, DeliveryMethod != "504REFI")
unique(df_new$LoanStatus)
# Removing the first 3 columns of the data set  as they contain the common program info and a
# unique identifying name for every business
df_new <- df_new[,-c(1,2,3)]
head(df_new)
# Removing the column BorrZip Code
df_new <- df_new[,-c(3)]
head(df_new)
# Removing CDC street, city, zip
df_new <- df_new[,-c(4,5,6,7)]
# Adding 4 columns - isDefault, NotSameState, ThirdPartyApproved and dayselapsed
df_new$isDefault <- ifelse(df_new$LoanStatus=="CHGOFF",1,0)
df_new$isDefault <- factor(df_new$isDefault)
df_new$NotSameState <- factor(df_new$NotSameState)
df_new$ThirdPartyApproved <- factor(df_new$ThirdPartyApproved)
df_new <- mutate(df_new,dayselapsed = as.numeric(difftime(strptime(ChargeOffDate, format = "%m/%d/%Y"),
strptime(ApprovalDate, format = "%m/%d/%Y"))))
df_new$dayselapsed[is.na(df_new$dayselapsed)] <- 7300
head(df_new$dayselapsed)
# Removing the Third Party Lender Name, City, State
df_new <- df_new[,-c(4,5,6)]
# Removing subpgmdesc
df_new <- df_new[,-c(9)]
# Removing NAICS description
df_new <- df_new[,-c(12)]
# Removing Project County and State
df_new <- df_new[,-c(12,13)]
#Macroeconomic data sets
unemployment_data=read.csv("emp-unemployment.csv")
#FED Interest Rate data per year (Source: https://fred.stlouisfed.org/series/DFF/downloaddata)
interest_rates_data=read.csv("FED_IR.csv")
#Total Economic Cost due to Tornados per year per state  http://www.spc.noaa.gov/wcm/test.html (manipulated using R and excel)
Tornado_damage_economic=read.csv("Tornado FL.csv")
#Small Business Lending data stats per state for 2011 (https://www.sba.gov/advocacy/firm-size-data) and https://www.sba.gov/content/small-business-lending-united-states-2010-2011
Small_business_lending_data=read.csv("Small_Business_lending_stats.csv")
SBLR=c(rep(0,length(df_new$BorrState)))
for (i in 1:length(df_new$BorrState)) {
SBLR[i]=Small_business_lending_data[match(df_new$BorrState[i],Small_business_lending_data$State),5]
}
#Add small business loan ratio (total small business loans issued/total small businesses per state )
df_new=cbind(df_new,SBLR)
# Average HPI Index by State for 1990-2016
hpi_state <- read.csv("hpi_state.csv", header=TRUE, stringsAsFactors=FALSE)
df_new <- left_join(df_new, hpi_state, by=c("ProjectState", "ApprovalFiscalYear"))
rm(list = ls())
library(dplyr)
library(GGally)
library(survival)
library(ROCR)
df <- read.csv("SBA_loan_data_new.csv")
set.seed(1)
# Creating a copy of the original dataframe for our operations
df_new <- df
# Macroeconomic data sets
unemployment_data <- read.csv("emp-unemployment.csv")
# FED Interest Rate data per year (Source: https://fred.stlouisfed.org/series/DFF/downloaddata)
interest_rates_data <- read.csv("FED_IR.csv")
# Total Economic Cost due to Tornados per year per state  http://www.spc.noaa.gov/wcm/test.html (manipulated using R and excel)
Tornado_damage_economic <- read.csv("Tornado FL.csv")
# Small Business Lending data stats per state for 2011 (https://www.sba.gov/advocacy/firm-size-data) and https://www.sba.gov/content/small-business-lending-united-states-2010-2011
Small_business_lending_data <- read.csv("Small_Business_lending_stats.csv")
SBLR <- c(rep(0,length(df_new$BorrState)))
for (i in 1:length(df_new$BorrState)) {
SBLR[i]=Small_business_lending_data[match(df_new$BorrState[i],Small_business_lending_data$State),5]
}
#Add small business loan ratio (total small business loans issued/total small businesses per state )
df_new=cbind(df_new,SBLR)
# Average HPI Index by State for 1990-2016
hpi_state <- read.csv("hpi_state.csv", header=TRUE, stringsAsFactors=FALSE)
df_new <- left_join(df_new, hpi_state, by=c("ProjectState", "ApprovalFiscalYear"))
View(df_new)
View(Tornado_damage_economic)
